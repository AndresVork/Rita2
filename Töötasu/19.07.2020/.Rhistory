my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
remove.packages("xlsx")
install.packages("xlsx")
# Lae andmed salvestatud excelist
# install.packages("xlsx")
library(xlsx)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
remove.packages("xlsx")
read_excel
?read_excel()
install.packages("openxlsx")
# Lae andmed salvestatud excelist
# install.packages("openxlsx")
library(openxlsx)
?read.xlsx
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(xlsxFile="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
str(my.data)
# Toimib
my.data <- read.xlsx(xlsxFile="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 6,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
str(my.data)
my.data <- as_tibble(my.data)
library(tidyverse)
my.data <- as_tibble(my.data)
str(my.data)
my.data
# Konverteeri osad lahtrid numbriteks
my.data$arv = as.numeric(as.character(my.data$Hüvitise.saajate.arv))
my.data$summa = as.numeric(as.character(gsub(",", "\\.", my.data$Hüvitiste.brutosumma.EUR)))
my.data$kulu = as.numeric(as.character(gsub(",", "\\.", my.data$Hüvitiste.kogukulu.EUR)))
my.data
str(my.data)
head(my.data)
# kustuta liigsed veerud
my.data$Tegevusala..EMTAK.2.kood. <- NULL
my.data$Hüvitise.saajate.arv <- NULL
my.data$Hüvitiste.brutosumma.EUR <- NULL
my.data$Hüvitiste.kogukulu.EUR <- NULL
# Konverteeri Osad andmed faktoriteks
my.data$Asutuse.registrikood = as.factor(my.data$Asutuse.registrikood)
# Muuda nimed
colnames(my.data) <- c("kood", "nimi", "maakond", "tegevusala", "EMTAK.2", "arv_1_kuu", "arv_2_kuu", "arv_3_kuu", "kogukulu", "arv", "brutosumma")
# konverteeri veel faktoriteks
my.data$nimi <- as.factor(my.data$nimi)
my.data$maakond <- as.factor(my.data$maakond)
my.data$tegevusala <- as.factor(my.data$tegevusala)
my.data$EMTAK.2 <- as.factor(my.data$EMTAK.2)
# ja numbriteks
my.data$arv_1_kuu = as.numeric(as.character(my.data$arv_1_kuu))
my.data$arv_2_kuu = as.numeric(as.character(my.data$arv_2_kuu))
my.data$arv_3_kuu = as.numeric(as.character(my.data$arv_3_kuu))
# konttrolli andmeid
str(my.data)
head(my.data)
# tagasi
my.data$kood <- as.character(my.data$kood)
my.data$nimi <- as.character(my.data$nimi)
# konttrolli andmeid
str(my.data)
head(my.data)
tail(my.data)
geom_density
library(tidyverse)
# Kontrolli töökataloogi asukohta
getwd()
load(andmed.rdata)
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
# setwd(file.path("/home/raoul/Dokumendid/RM/Töötasu"))
# Kontrolli töökataloogi asukohta
getwd()
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# Kontrolli töökataloogi asukohta
getwd()
# lae andmed
load(andmed.rdata)
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
# Kontrolli töökataloogi asukohta
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# lae andmed
load(andmed.rdata)
# lae andmed
load("andmed.rdata")
tail(my.data)
View(my.data)
# Lae andmed salvestatud excelist
library(openxlsx)
library(tidyverse)
# Määra töökaust, mida kasutatakse andmete laadimiseks
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# Lae andmed
data.weeks <- read.xlsx(xlsxFile=local,
sheet = 1,
startRow=2)
my.data <- NULL
# Määra töökaust, mida kasutatakse andmete laadimiseks
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# 1. - sisesta veebilehe aadress (sõltub kuupäevast)
url <- "https://www.tootukassa.ee/sites/tootukassa.ee/files/asutuste_nimekiri_09.08.2020.xlsx"
# Määra (kaust) ja fail kuhu andmed salvestatakse
folder <- "August.2020"
dir.create(folder)
local <- file.path(folder, "andmed_09082020.xlsx")
# Lae fail alla
download.file(url, local)
# Lae andmed
data.weeks <- read.xlsx(xlsxFile=local,
sheet = 1,
startRow=2)
data.03 <- read.xlsx(xlsxFile=local,
sheet = 2,
startRow=2)
data.04 <- read.xlsx(xlsxFile=local,
sheet = 3,
startRow=2)
data.05 <- read.xlsx(xlsxFile=local,
sheet = 4,
startRow=2)
data.06 <- read.xlsx(xlsxFile=local,
sheet = 5,
startRow=2)
data.koond<- read.xlsx(xlsxFile=local,
sheet = 6,
startRow=2)
# Konverteri tibbleks
data.03 <- as_tibble(data.03)
data.04 <- as_tibble(data.04)
data.05 <- as_tibble(data.05)
data.06 <- as_tibble(data.06)
data.koond <- as_tibble(data.koond)
data.weeks <- as_tibble(data.weeks)
View(data.koond)
tail(data.koond)
tail(data.weeks)
View(data.06)
tail(data.koond)
head(data.koond)
# Korrasta andmed
# asenda tedmata arvud NA väärtusega
str(data.koond)
# Korrasta andmed
# Nimetused
colnames(data.koond) <- c("kood", "nimi", "maakond", "EMTAK.1", "EMTAK.2", "EMTAK.2.kood", "arv", "arv_1_kuu", "arv_2_kuu", "arv_3_kuu", "brutosumma", "kogukulu")
# asenda tedmata arvud NA väärtusega
data.koond$
str(data.koond)
# Korrasta andmed
# Nimetused
colnames(data.koond) <- c("kood", "nimi", "maakond", "EMTAK.1", "EMTAK.2", "EMTAK.2.kood", "arv", "arv_1_kuu", "arv_2_kuu", "arv_3_kuu", "brutosumma", "kogukulu")
# asenda tedmata arvud NA väärtusega
data.koond$
str(data.koond)
head(data.koond)
View(data.kood)
View(data.koond)
# asenda tedmata arvud NA väärtusega
data.koond$arv <- as.numeric(ifelse(data.koond$arv = '-', NA, data.koond$arv))
# asenda tedmata arvud NA väärtusega
data.koond$arv <- as.numeric(ifelse(data.koond$arv == '-', NA, data.koond$arv))
str(data.koond)
head(data.koond)
tail(data.koond)
data.koond$maakond = as.factor(data.koond$maakond)
data.koond$EMTAK.1 = as.factor(data.koond$EMTAK.1)
data.koond$EMTAK.2 = as.factor(data.koond$EMTAK.2)
data.koond$EMTAK.2.kood = as.factor(data.koond$EMTAK.2.kood)
str(data.koond)
data.koond$arv_1_kuu <- as.numeric(ifelse(data.koond$arv_1_kuu == '-', NA, data.koond$arv_1_kuu))
str(data.koond)
data.koond$arv_2_kuu <- as.numeric(ifelse(data.koond$arv_2_kuu == '-', NA, data.koond$arv_2_kuu))
data.koond$arv_3_kuu <- as.numeric(ifelse(data.koond$arv_3_kuu == '-', NA, data.koond$arv_3_kuu))
str(data.koond)
View(data.koond)
save(data.koond, file="koond.rdata")
# Lisa EMTAK.1 kood
data.koond$EMTAK.1.kood = data.koond$EMTAK.1
str(data.koond)
unique(data$EMTAK.1.kood)
unique(data.koond$EMTAK.1.kood)
data.koond <- mutate(data.koond, EMTAK.1.kood =
revalue(EMTAK.1.kood,
c(
"HULGI- JA JAEKAUBANDUS; MOOTORSÕIDUKITE JA MOOTORRATASTE REMONT" = "G",
"HULGI- JA JAEKAUBANDUS; MOOTORSŐIDUKITE JA MOOTORRATASTE REMONT" = "G",
"INFO JA SIDE" = "J",
"PÕLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"PŐLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"TÖÖTLEV TÖÖSTUS" = "C",
"KUTSE-, TEADUS- JA TEHNIKAALANE TEGEVUS" = "M",
"EHITUS" = "F",
"KINNISVARAALANE TEGEVUS" = "L",
"VEONDUS JA LAONDUS" = "H",
"HALDUS- JA ABITEGEVUSED" = "N",
"MAJUTUS JA TOITLUSTUS" = "I",
"TERVISHOID JA SOTSIAALHOOLEKANNE" = "Q",
"VEEVARUSTUS; KANALISATSIOON; JÄÄTME- JA SAASTEKÄITLUS" = "E",
"MUUD TEENINDAVAD TEGEVUSED" = "S",
"FINANTS- JA KINDLUSTUSTEGEVUS" = "K",
"MÄETÖÖSTUS" = "B",
"HARIDUS" = "P",
#                           "" = NA,
"KUNST, MEELELAHUTUS JA VABA AEG" = "R",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ŐHUGA VARUSTAMINE" = "D",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ÕHUGA VARUSTAMINE" = "D",
" AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"EKSTERRITORIAALSETE ORGANISATSIOONIDE JA ÜKSUSTE TEGEVUS" = "U",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MŐELDUD ERISTAMATA KAUPAD" = "T",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MÕELDUD ERISTAMATA KAUPAD" = "T"
)
)
)
detach(package:dplyr)
library(plyr)         # EMTAK 2020 koodide asendamiseks - muutmiseks
data.koond <- mutate(data.koond, EMTAK.1.kood =
revalue(EMTAK.1.kood,
c(
"HULGI- JA JAEKAUBANDUS; MOOTORSÕIDUKITE JA MOOTORRATASTE REMONT" = "G",
"HULGI- JA JAEKAUBANDUS; MOOTORSŐIDUKITE JA MOOTORRATASTE REMONT" = "G",
"INFO JA SIDE" = "J",
"PÕLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"PŐLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"TÖÖTLEV TÖÖSTUS" = "C",
"KUTSE-, TEADUS- JA TEHNIKAALANE TEGEVUS" = "M",
"EHITUS" = "F",
"KINNISVARAALANE TEGEVUS" = "L",
"VEONDUS JA LAONDUS" = "H",
"HALDUS- JA ABITEGEVUSED" = "N",
"MAJUTUS JA TOITLUSTUS" = "I",
"TERVISHOID JA SOTSIAALHOOLEKANNE" = "Q",
"VEEVARUSTUS; KANALISATSIOON; JÄÄTME- JA SAASTEKÄITLUS" = "E",
"MUUD TEENINDAVAD TEGEVUSED" = "S",
"FINANTS- JA KINDLUSTUSTEGEVUS" = "K",
"MÄETÖÖSTUS" = "B",
"HARIDUS" = "P",
#                           "" = NA,
"KUNST, MEELELAHUTUS JA VABA AEG" = "R",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ŐHUGA VARUSTAMINE" = "D",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ÕHUGA VARUSTAMINE" = "D",
" AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"EKSTERRITORIAALSETE ORGANISATSIOONIDE JA ÜKSUSTE TEGEVUS" = "U",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MŐELDUD ERISTAMATA KAUPAD" = "T",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MÕELDUD ERISTAMATA KAUPAD" = "T"
)
)
)
unique(data.koond$EMTAK.1.kood)
detach(package:plyr)
library(dplyr)
rename(data.koond, EMTAK.1 = EMTAK)
rename(data.koond, EMTAK = EMTAK.1)
rename(data.koond, EMTAK.kood = EMTAK.1.kood)
rename(data.koond, EMTAK = EMTAK.1)
rename(data.koond, EMTAK.kood = EMTAK.1.kood)
rename(data.koond, EMTAK.1 = EMTAK)
rename(data.koond, EMTAK = EMTAK.1)
rename(data.koond, EMTAK.kood = EMTAK.1.kood)
# Aseta EMTAK.1.kood EMTAK'i järele
data.koond <- data.koond %>% relocate(EMTAK.kood, .after = EMTAK)
str(data.koond)
# Aseta EMTAK.1.kood EMTAK'i järele
data.koond <- data.koond %>%
rename(data.koond, EMTAK = EMTAK.1) %>%
rename(data.koond, EMTAK.kood = EMTAK.1.kood) %>%
relocate(EMTAK.kood, .after = EMTAK)
# Aseta EMTAK.1.kood EMTAK'i järele
data.koond <- data.koond %>%
rename(data.koond, EMTAK = EMTAK.1) %>%
rename(data.koond, EMTAK.kood = EMTAK.1.kood) %>%
relocate(EMTAK.kood, .after = EMTAK)
str(data.koond)
# Aseta EMTAK.1.kood EMTAK'i järele
data.koond <- data.koond %>%
rename(data.koond, EMTAK = EMTAK.1) %>%
rename(data.koond, EMTAK.kood = EMTAK.1.kood)
# Aseta EMTAK.1.kood EMTAK'i järele
data.koond <- data.koond %>%
rename(EMTAK = EMTAK.1) %>%
rename(EMTAK.kood = EMTAK.1.kood) %>%
relocate(EMTAK.kood, .after = EMTAK)
str(data.koond)
save(data.koond, file="koond.rdata")
View(data.koond)
View(data.koond)
View(data.06)
data.koond.06 <- merge(data.koond, data.06, by="Registrikood")
str(data.06)
colnames(data.06) <- c("kood", "nimi", "maakond", "EMTAK", "EMTAK.2", "EMTAK.2.kood", "kuu", "arv", "brutosumma", "kogukulu")
View(data.06)
# asenda tedmata arvud NA väärtusega
data.06$arv <- as.numeric(ifelse(data.06$arv == '-', NA, data.06$arv))
data.06$maakond = as.factor(data.06$maakond)
data.06$EMTAK = as.factor(data.06$EMTAK)
data.06$EMTAK.2 = as.factor(data.06$EMTAK.2)
data.06$EMTAK.2.kood = as.factor(data.06$EMTAK.2.kood)
str(data.06)
# Lisa EMTAK.1 kood
data.06$EMTAK.kood = data.06$EMTAK
unique(data.06$EMTAK.kood)
detach(package:dplyr)
library(plyr)         # EMTAK 2020 koodide asendamiseks - muutmiseks
data.06 <- mutate(data.06, EMTAK.kood =
revalue(EMTAK.kood,
c(
"HULGI- JA JAEKAUBANDUS; MOOTORSÕIDUKITE JA MOOTORRATASTE REMONT" = "G",
"HULGI- JA JAEKAUBANDUS; MOOTORSŐIDUKITE JA MOOTORRATASTE REMONT" = "G",
"INFO JA SIDE" = "J",
"PÕLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"PŐLLUMAJANDUS, METSAMAJANDUS JA KALAPÜÜK" = "A",
"TÖÖTLEV TÖÖSTUS" = "C",
"KUTSE-, TEADUS- JA TEHNIKAALANE TEGEVUS" = "M",
"EHITUS" = "F",
"KINNISVARAALANE TEGEVUS" = "L",
"VEONDUS JA LAONDUS" = "H",
"HALDUS- JA ABITEGEVUSED" = "N",
"MAJUTUS JA TOITLUSTUS" = "I",
"TERVISHOID JA SOTSIAALHOOLEKANNE" = "Q",
"VEEVARUSTUS; KANALISATSIOON; JÄÄTME- JA SAASTEKÄITLUS" = "E",
"MUUD TEENINDAVAD TEGEVUSED" = "S",
"FINANTS- JA KINDLUSTUSTEGEVUS" = "K",
"MÄETÖÖSTUS" = "B",
"HARIDUS" = "P",
#                           "" = NA,
"KUNST, MEELELAHUTUS JA VABA AEG" = "R",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ŐHUGA VARUSTAMINE" = "D",
"ELEKTRIENERGIA, GAASI, AURU JA KONDITSIONEERITUD ÕHUGA VARUSTAMINE" = "D",
" AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"AVALIK HALDUS JA RIIGIKAITSE; KOHUSTUSLIK SOTSIAALKINDLUSTUS" = "O",
"EKSTERRITORIAALSETE ORGANISATSIOONIDE JA ÜKSUSTE TEGEVUS" = "U",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MŐELDUD ERISTAMATA KAUPAD" = "T",
"KODUMAJAPIDAMISTE KUI TÖÖANDJATE TEGEVUS; KODUMAJAPIDAMISTE OMA TARBEKS MÕELDUD ERISTAMATA KAUPAD" = "T"
)
)
)
detach(package:plyr)
library(dplyr)
str(data.06)
unique(data.06$EMTAK.kood)
# Aseta EMTAK.1.kood EMTAK'i järele
data.06 <- data.06 %>%
rename(EMTAK = EMTAK.1) %>%
rename(EMTAK.kood = EMTAK.1.kood) %>%
relocate(EMTAK.kood, .after = EMTAK)
# Aseta EMTAK.1.kood EMTAK'i järele
data.06 <- data.06 %>%
relocate(EMTAK.kood, .after = EMTAK)
save(data.06, file="juuni.rdata")
str(data.06)
data.koond.06 <- merge(data.koond, data.06, by="kood")
data.koond.06 <- left_join(data.koond, data.06, by="kood")
?left_join
View(data.koond.06)
data.koond.06 <- semi_join(data.koond, data.06, by="kood")
View(data.koond.06)
data.koond.06 <- left_join(data.koond, data.06, by="kood")
data.koond.06 <- semi_join(data.koond, data.06, by="kood")
data.koond.06 <- right_join(data.koond, data.06, by="kood")
View(data.koond.06)
?right_join
data.koond.06 <- right_join(data.koond, data.06, by=c("kood", "nimi"))
data.koond.06 <- semi_join(data.koond, data.06, by=c("kood", "nimi"))
data.koond.06 <- left_join(data.koond, data.06, by=c("kood", "nimi"))
View(data.koond.06)
# Koosta ühendandmebaas
data.koond.06 <-
left_join(data.koond, data.06, by=c("kood", "nimi")) %>%
str(data_koond.06)
# Koosta ühendandmebaas
data.koond.06 <-
left_join(data.koond, data.06, by=c("kood", "nimi")) %>%
str(data_koond.06)
# Koosta ühendandmebaas
data.koond.06 <- left_join(data.koond, data.06, by=c("kood", "nimi"))
str(data_koond.06)
str(data.koond.06)
# Koosta ühendandmebaas
data.koond.06 <- left_join(data.koond, data.06, by=c("kood", "nimi"), suffix=(c("", ".y")))
str(data.koond.06)
data.koond.06.f <- select(data.koond.06, -c("maakond.x"))
data.koond.06.f <- select(data.koond.06, -c("maakond.y"))
str(data.koond.06)
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y"))
str(data.koond.06.f)
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y")) %>%
rename(arv_4_kuu = arv.y) %>%
relocate(arv_4_kuu, .after=arv_3_kuu)
str(data.koond.06.f)
View(data.koond.06.f)
? 5 && 6
5 && 6
1 && 2
FALSE && TRUE
TRUE && TRUE
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuu <- ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
str(data.koond.06.f)
View(data.koond.06.f)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuu <- ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
# Koosta ühendandmebaas
data.koond.06 <- left_join(data.koond, data.06, by=c("kood", "nimi"), suffix=(c("", ".y")))
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y")) %>%
rename(arv_4_kuu = arv.y) %>%
relocate(arv_4_kuu, .after=arv_3_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuu = ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y")) %>%
rename(arv_4_kuu = arv.y) %>%
relocate(arv_4_kuu, .after=arv_3_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuu  <- ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06.f$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y")) %>%
rename(arv_4_kuu = arv.y) %>%
relocate(arv_4_kuu, .after=arv_3_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuu  <- ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06.f$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
data.koond.06.f <- select(data.koond.06, -c("maakond.y", "EMTAK.y", "EMTAK.kood.y", "EMTAK.2.y", "EMTAK.2.kood.y")) %>%
rename(arv_4_kuu = arv.y) %>%
relocate(arv_4_kuu, .after=arv_3_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06.f$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse((is.na(data.koond.06.f$arv_4_kuu) && data.koond.06.f$arv_3_kuu > -1), 0, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = data.koond.06.f$arv_4_kuu
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu), 0, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu) && !is.na(data.koond.06.f$arv_3_kuu), 0, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu) && data.koond.06.f$arv_3_kuu == 0, 0, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_3_kuu), NA, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = data.koond.06.f$arv_3_kuu + data.koond.06.f$arv_4_kuu
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu), NA, data.koond.06.f$arv_4_kuu)
# Kui hüvitiste saajate arv on üldiselt teada, aga juuni on NA, siis see tähendab, et juunis ei taotletudaa
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv_4_kuu), 0, data.koond.06.f$arv_4_kuu)
data.koond.06.f$arv_4_kuux = ifels(is.na(data.koond.06.f$arv), NA, data.koond.06.f$arv_4_kuux)
data.koond.06.f$arv_4_kuux = ifelse(is.na(data.koond.06.f$arv), NA, data.koond.06.f$arv_4_kuux)
data.koond.06.f$arv_4_kuu = ifelse(is.na(data.koond.06.f$arv), NA, data.koond.06.f$arv_4_kuux)
# viska liigne minema
str(data.koond.06.f)
# basic
b <- ggplot(data.koond, aes(x = brutosumma/arv, y=fct_infreq(tegevusala)))
# boxplot
b + geom_boxplot(aes(y=maakond), outlier.colour="red", outlier.shape=8,) +
geom_jitter(shape=16, position=position_jitter(0.2))
# basic
b <- ggplot(data.koond, aes(x = brutosumma/arv, y=fct_infreq(EMTAK)))
# boxplot
b + geom_boxplot(aes(y=maakond), outlier.colour="red", outlier.shape=8,) +
geom_jitter(shape=16, position=position_jitter(0.2))
View(data.koond)
View(data.koond)
# filtreeritud
b.ehitus <- subset(data.koond, EMTAK %in% c("VEONDUS JA LAONDUS"))
View(b.ehitus)
b.plot.ehitus <- ggplot(b.ehitus, aes(x = brutosumma/arv, y=EMTAK.2)) +
theme(
text = element_text(size=12),
axis.text.y = element_text(size=12)
)
b.plot.ehitus + geom_jitter(shape=16, position=position_jitter(0.2), colour="deepskyblue2",  aplha = I(0.6)) +
geom_boxplot(alpha = I(0.6), outlier.shape=NA)
View(data.koond)
