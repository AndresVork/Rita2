#Impordi exceli andmed Töötukassa koduleheküljelt
# 1. veebilehe aadress (sõltub kuupäevast)
url <- "https://www.tootukassa.ee/sites/tootukassa.ee/files/asutuste_nimekiri_19.07.2020.xlsx"
# Määra töökaust, mida kasutatakse andmete laadimiseks
setwd(file.path("/home/raoul/Dokumendid/RM/Töötasu"))
# Kontrolli töökataloogi asukohta
getwd()
# Määra (kaust) ja fail kuhu andmed salvestatakse
folder <- "19.07.2020"
# Lae andmed salvestatud excelist
# install.packages("xlsx")
library("xlsx")
library(tidyverse)
# Toimib
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/17.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Toimib
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
remove.packages("xlsx")
install.packages("xlsx")
# Lae andmed salvestatud excelist
# install.packages("xlsx")
library(xlsx)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
remove.packages("xlsx")
read_excel
?read_excel()
install.packages("openxlsx")
# Lae andmed salvestatud excelist
# install.packages("openxlsx")
library(openxlsx)
?read.xlsx
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheetIndex = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(file="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
# Ei toimi
my.data <- read.xlsx(xlsxFile="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 5,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
str(my.data)
# Toimib
my.data <- read.xlsx(xlsxFile="/home/raoul/Dokumendid/RM/Töötasu/19.07.2020/andmed.xlsx",
sheet = 6,
#sheetName="Asutuste kokkuvõte_koond",
startRow=2)
str(my.data)
my.data <- as_tibble(my.data)
library(tidyverse)
my.data <- as_tibble(my.data)
str(my.data)
my.data
# Konverteeri osad lahtrid numbriteks
my.data$arv = as.numeric(as.character(my.data$Hüvitise.saajate.arv))
my.data$summa = as.numeric(as.character(gsub(",", "\\.", my.data$Hüvitiste.brutosumma.EUR)))
my.data$kulu = as.numeric(as.character(gsub(",", "\\.", my.data$Hüvitiste.kogukulu.EUR)))
my.data
str(my.data)
head(my.data)
# kustuta liigsed veerud
my.data$Tegevusala..EMTAK.2.kood. <- NULL
my.data$Hüvitise.saajate.arv <- NULL
my.data$Hüvitiste.brutosumma.EUR <- NULL
my.data$Hüvitiste.kogukulu.EUR <- NULL
# Konverteeri Osad andmed faktoriteks
my.data$Asutuse.registrikood = as.factor(my.data$Asutuse.registrikood)
# Muuda nimed
colnames(my.data) <- c("kood", "nimi", "maakond", "tegevusala", "EMTAK.2", "arv_1_kuu", "arv_2_kuu", "arv_3_kuu", "kogukulu", "arv", "brutosumma")
# konverteeri veel faktoriteks
my.data$nimi <- as.factor(my.data$nimi)
my.data$maakond <- as.factor(my.data$maakond)
my.data$tegevusala <- as.factor(my.data$tegevusala)
my.data$EMTAK.2 <- as.factor(my.data$EMTAK.2)
# ja numbriteks
my.data$arv_1_kuu = as.numeric(as.character(my.data$arv_1_kuu))
my.data$arv_2_kuu = as.numeric(as.character(my.data$arv_2_kuu))
my.data$arv_3_kuu = as.numeric(as.character(my.data$arv_3_kuu))
# konttrolli andmeid
str(my.data)
head(my.data)
# tagasi
my.data$kood <- as.character(my.data$kood)
my.data$nimi <- as.character(my.data$nimi)
# konttrolli andmeid
str(my.data)
head(my.data)
tail(my.data)
geom_density
library(tidyverse)
# Kontrolli töökataloogi asukohta
getwd()
load(andmed.rdata)
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
# setwd(file.path("/home/raoul/Dokumendid/RM/Töötasu"))
# Kontrolli töökataloogi asukohta
getwd()
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# Kontrolli töökataloogi asukohta
getwd()
# lae andmed
load(andmed.rdata)
############################################
# Töötab juba ettevalmistatud tööturu andmetega
############################################
# Kontrolli töökataloogi asukohta
setwd(file.path("/home/raoul/Dokumendid/R/Töötasu"))
# lae andmed
load(andmed.rdata)
# lae andmed
load("andmed.rdata")
tail(my.data)
View(my.data)
